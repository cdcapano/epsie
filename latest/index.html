<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EPSIE &mdash; EPSIE 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Quick Start" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="#" class="icon icon-home"> EPSIE
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelization.html">Parallelization</a></li>
<li class="toctree-l1"><a class="reference internal" href="proposals.html">Proposals</a></li>
<li class="toctree-l1"><a class="reference internal" href="epsie.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/01-chain.html">Using a chain</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/02-mhsampler.html">Example of creating and running a Metropolis-Hastings Sampler</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/03-ptsampler.html">Example of creating and running a Parallel Tempered Sampler</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/test_adaptive_normal.html">Use the Veitch et al. Adaptive Normal proposal with the Parallel Tempered Sampler</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/test_angular.html">The Angular proposal</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/test_at_adaptive_normal.html">The AT Adaptive Normal proposal</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">EPSIE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
      <li>EPSIE</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/cdcapano/epsie/blob/master/docs/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="epsie">
<h1>EPSIE<a class="headerlink" href="#epsie" title="Permalink to this headline"></a></h1>
<p>EPSIE is a parallelized Markov chain Monte Carlo (MCMC) sampler for Bayesian
inference. It is meant for problems with complicated likelihood topology,
including multimodal distributions.  It has support for both parallel tempering
and nested transdimensional problems. It was originally developed for
gravitational-wave parameter estimation, but can be used for any Bayesian
inference problem requring a stochastic sampler.</p>
<p>EPSIE is in many ways similar to <a class="reference external" href="https://emcee.readthedocs.io/en/stable/">emcee</a> and other bring-your-own-likelihood
Python-based samplers. The primary difference from emcee is EPSIE
is not an ensemble sampler; i.e., the Markov chains used by EPSIE do not
attempt to share information between each other. Instead, to speed convergence,
multiple jump proposal classes are offered that can be customized to the
problem at hand.  These include adaptive proposals that attempt to learn the
shape of the distribution during a burn-in period. The user can also easily
create their own jump proposals.</p>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline"></a></h2>
<p>The easiest way to install EPSIE is via pip:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install epsie
</pre></div>
</div>
<p>If you wish to install from the latest source code instead, you can clone a
copy of the repository from GitHub, at <a class="reference external" href="https://github.com/cdcapano/epsie">https://github.com/cdcapano/epsie</a>.</p>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline"></a></h3>
<p>EPSIE requires Python 3.6 or later. The number of required dependencies for
EPSIE is purposely kept to a minimum, to make for a light weight, quick to
install package. You can find the required packages in the <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>
file. If you are installing from source, these can be installed via pip with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -r requirements.txt
</pre></div>
</div>
<p>Optional dependencies can be found in <code class="docutils literal notranslate"><span class="pre">companion.txt</span></code>. These are needed for
running the tutorials and building documentation, but are not necessary for
regular use.</p>
</section>
</section>
<section id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline"></a></h2>
<p>Two samplers are provided: the
<a class="reference internal" href="epsie.samplers.html#epsie.samplers.mhsampler.MetropolisHastingsSampler" title="epsie.samplers.mhsampler.MetropolisHastingsSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisHastingsSampler</span></code></a> and the
<a class="reference internal" href="epsie.samplers.html#epsie.samplers.ptsampler.ParallelTemperedSampler" title="epsie.samplers.ptsampler.ParallelTemperedSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ParallelTemperedSampler</span></code></a>.
Parallel tempering is useful for multi-modal distributions and for estimating
Bayesian evidence, but is more computationally expensive.</p>
<p>To use either sampler, you provide a function that evaluates the likelihood and
prior at given points. This function must take keyword arguments as input that
map parameter names to values and return a tuple of the log likelihood and log
prior at that point. The function may also return “blob” data, which is a
dictionary of additional statistics that you would like to keep track of, but
this is optional.</p>
<p>For example, the following sets up the Metropolis-Hastings sampler with 3
chains to sample a 2D normal distribution, with a prior uniform between [-5, 5)
on each parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create the function to evaluate</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Evaluate model at given point.&quot;&quot;&quot;</span>
    <span class="n">logp</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">logpdf</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">loc</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">logl</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">logpdf</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">logl</span><span class="p">,</span> <span class="n">logp</span>

<span class="c1"># set up the sampler</span>
<span class="kn">from</span> <span class="nn">epsie.samplers</span> <span class="kn">import</span> <span class="n">MetropolisHastingsSampler</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="n">nchains</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">MetropolisHastingsSampler</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">nchains</span><span class="p">)</span>

<span class="c1"># set the start positions: we&#39;ll just draw from the prior</span>
<span class="n">sampler</span><span class="o">.</span><span class="n">start_position</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">nchains</span><span class="p">,</span> <span class="n">loc</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">nchains</span><span class="p">,</span> <span class="n">loc</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="p">}</span>

<span class="c1"># run for a few iterations</span>
<span class="n">sampler</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># retrieve positions</span>
<span class="n">positions</span> <span class="o">=</span> <span class="n">sampler</span><span class="o">.</span><span class="n">positions</span>
<span class="c1"># positions is numpy structured array with shape nchains x niterations</span>
<span class="nb">print</span><span class="p">(</span><span class="n">positions</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">positions</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>In this simple example we have used the default
<a class="reference internal" href="epsie.proposals.html#epsie.proposals.normal.Normal" title="epsie.proposals.normal.Normal"><code class="xref py py-class docutils literal notranslate"><span class="pre">Normal</span></code></a> proposal class for producing
jumps, and have used only a single core.</p>
<p>To learn how to use more advanced features and how to interact with
sampler data, see the notebooks provided in the <a class="reference internal" href="tutorials.html"><span class="doc">tutorials</span></a>.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="parallelization.html">Parallelization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html#using-python-s-multiprocessing">Using Python’s multiprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallelization.html#using-mpi">Using MPI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="proposals.html">Proposals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="proposals.html#creating-custom-proposals">Creating Custom Proposals</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="epsie.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="epsie.html#subpackages">Subpackages</a></li>
<li class="toctree-l2"><a class="reference internal" href="epsie.html#module-epsie">Module contents</a></li>
</ul>
</li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/01-chain.html">Using a chain</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/02-mhsampler.html">Example of creating and running a Metropolis-Hastings Sampler</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/02-mhsampler.html#create-the-model-to-sample">Create the model to sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/02-mhsampler.html#setup-and-run-the-sampler">Setup and run the sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/02-mhsampler.html#extract-results">Extract results</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/02-mhsampler.html#resume-from-a-state">Resume from a state</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/02-mhsampler.html#clearing-memory-and-continuing">Clearing memory and continuing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/02-mhsampler.html#plot-the-posterior">Plot the posterior</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/02-mhsampler.html#create-an-animation-of-the-results">Create an animation of the results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/03-ptsampler.html">Example of creating and running a Parallel Tempered Sampler</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/03-ptsampler.html#create-the-model-to-sample">Create the model to sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/03-ptsampler.html#setup-and-run-the-sampler">Setup and run the sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/03-ptsampler.html#extract-results">Extract results</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/03-ptsampler.html#resume-from-a-state">Resume from a state</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/03-ptsampler.html#clearing-memory-and-continuing">Clearing memory and continuing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/03-ptsampler.html#plot-acceptance-rates">Plot acceptance rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/03-ptsampler.html#plot-temperature-swaps">Plot temperature swaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/03-ptsampler.html#plot-the-posterior">Plot the posterior</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/03-ptsampler.html#create-an-animation-of-the-results">Create an animation of the results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/test_adaptive_normal.html">Use the Veitch et al. Adaptive Normal proposal with the Parallel Tempered Sampler</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_adaptive_normal.html#create-the-model-to-sample">Create the model to sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_adaptive_normal.html#setup-the-proposal">Setup the proposal</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_adaptive_normal.html#setup-and-run-the-sampler">Setup and run the sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_adaptive_normal.html#plot-acceptance-rates">Plot acceptance rates</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_adaptive_normal.html#resume-from-a-state">Resume from a state</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_adaptive_normal.html#clearing-memory-and-continuing">Clearing memory and continuing</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_adaptive_normal.html#plot-the-posterior">Plot the posterior</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/test_angular.html">The Angular proposal</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_angular.html#d-test">1D Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_angular.html#comparison-to-normal-proposal-1d">Comparison to Normal proposal: 1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_angular.html#timing-comparison">Timing comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_angular.html#id3">2D test</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_angular.html#with-adaptation-veitch-et-al-algorithm">With adaptation (Veitch et al. algorithm)</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_angular.html#id4">1D test</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_angular.html#id5">2D test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/test_at_adaptive_normal.html">The AT Adaptive Normal proposal</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_at_adaptive_normal.html#create-the-model-to-sample">Create the model to sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_at_adaptive_normal.html#setup-and-run-the-sampler">Setup and run the sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_at_adaptive_normal.html#extract-results">Extract results</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_at_adaptive_normal.html#plot-the-rolling-mean-acceptance-ratio">Plot the rolling mean acceptance ratio</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials/test_at_adaptive_normal.html#plot-the-posterior">Plot the posterior</a></li>
</ul>
</li>
</ul>
</div>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-right" title="Quick Start" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Collin D. Capano.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <!-- Modified from https://tech.michaelaltfield.net/2020/07/23/sphinx-rtd-github-pages-2/ -->


  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book">&nbsp; &nbsp;</span>
      Version: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl>
        
           <strong> 
          <dd><a href="">latest</a></dd>
           </strong> 
        
          
          <dd><a href="../1.0/index.html">1.0</a></dd>
          
        
      </dl>
      
      
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>